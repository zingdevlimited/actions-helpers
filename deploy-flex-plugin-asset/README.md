# Deploy Flex Plugin Asset

Deploy a Flex Plugin bundle.js file as an Asset to the Default Plugin Service (The one named `Flex Plugins Service (Autogenerated) - Do Not Delete`).

```yaml
steps:
  (...)

  - name: Deploy Plugin Bundle
    id: deployBundle
    uses: zingdevlimited/actions-helpers/deploy-flex-plugin-asset@v4
    with:
      FILE_PATH: my-plugin/build/my-plugin.js
      PLUGIN_NAME: my-plugin
      PLUGIN_VERSION: "1.0.0"
      ALLOW_VERSION_OVERWRITE: false
      TWILIO_API_KEY: ${{ env.TWILIO_API_KEY }}
      TWILIO_API_SECRET: ${{ env.TWILIO_API_SECRET }}

  - name: Check Bundle URL
    run: echo "${{ steps.deployBundle.outputs.ASSET_URL }}
```

**Outputs:**

- ASSET_URL

This action will do the following steps:

1. Check if the [Functions Service](https://www.twilio.com/docs/serverless/api/resource/service) `default` exists. If it does not, it will create it with the friendly name `Flex Plugins Service (Autogenerated) - Do Not Delete`.

2. Check if there is an [Environment](https://www.twilio.com/docs/serverless/api/resource/environment) with the unique name matching your plugin name. If it does not exist, it will create a new Environment with the unique name set to your plugin name, and the domain suffix as 7 random characters

3. Get all the [Asset Versions](https://www.twilio.com/docs/serverless/api/resource/asset-version) that were deployed to the last [Build](https://www.twilio.com/docs/serverless/api/resource/build) of the Environment.

4. If there is a deployed Asset Version that matches the current plugin version, check the input `ALLOW_VERSION_OVERWRITE`.
      - **If it is `true`**: The action will continue
      - **Otherwise**: The action will throw an error

5. Create a new Asset Version with your bundle file

6. Create a Build containing the new Asset Version **and** all the Asset Versions of the previous Build.

7. Deploy the Build to the Environment
